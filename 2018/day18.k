I:".|#"?I:0:"day18.txt"
I:4(+|0N,)/I
d:-1_#'*:\I
I:,/I
n:(!#I)+\:d/'+-1+!3 3
op:{x[1]>2}
tr:{1+x[2]>2}
lm:{2*&/0 1<1_x}
T:{{((op;tr;lm;:[;0N])3^x[4])@0^(#'=x)@!3}'x@n}

/`0:'".|#"d#/:
r:10T\I;
*/+/'1 2=\:*|r
U:I
X:()
W:40
{X::X,,.#'=U::T@U;r:x?x:(-W)#X;((#X)*W=#?r),r}\();
r:x?x:(-W)#X
c:1+|/r
*/(*(-c!1000000000-c+1)#X)1 2
