I:0:"day8.txt"

D:.''","\'I
dist:{+/x*x:-/x}''D@prs:,/:/'+(!#D;&'&\~=#D)
sz:-1_0,+\#'dist
fnd:{(y;x-sz[y])}/1(sz')\
lst:fnd'<,/dist

*/3#@/1>:\.#'=C:{.[x;2#,w:&|/x[y];|;~.[x;y]]}/[=#D;1000#prs .[;]/:lst]
c:0
(~&//*:){c+:1;(a;b):x;(.[a;2#,w:&|/a[b 0];|;~.[a;b 0]];1_b)}/(=#D;w:prs .[;]/:lst);
