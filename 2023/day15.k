I:","\*0:"day15.txt"

(L0;F):+_'/|1(0,/:&'~^"-="?)\I
F:.'1_'F
L:L0?L0

B:256#,(!0;!0)

add:{B[x]::B[x],'y}
del:{$[^i:B[x;0]?y;;B[x]::B[x]{?[x;y+!2;!0]}\:i];}
rpl:{$[^i:B[x;0]?y;add[x;z]; B[x]::{?[x;y+!2;z]}'[B[x];i;z]];}

h:{{256!17*x+y}/[0;x]}
+/h'I
H:h'L0

/ run the procedure
{$[(::)~z;del[H@y;y];rpl[H@y;y;(y,z)]]}/[();L;F]

+/,/(1+w)*/:'r@w:&~^*'r:(*/1(1+!#:)\)'B[;1]
