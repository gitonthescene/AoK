/ ngn/k
t:*0:"day16.txt"

bts:,/+2\."0x",,/+(,/$&#t;_t)
lt:{(6++/#'b;2/,/1_'b:(1+(l@5*!_(#l)%5)?0;5)#l:x)}
ev:{b:(x@1)_bts;(v;t):2/'2 3#b
    $[t=4;:@[v,lt 6_b;!2;+;x[!2]]
    [l:(:/)a:$[b@6
              (2/11#7_b)o\(*x;18+x@1;0)
              {x>y@1}[22+(x@1)+2/15#7_b]o\(*x;22+x@1;0)]
     @[l;0 2;:;(v+*l;(+;*;&;|;0N;>;<;=)[t]/*|+1_a)]]]}
r:ev 3#0
r[0 2]

\\
