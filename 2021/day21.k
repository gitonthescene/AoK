/ ngn/k
st:-1+`I$(*|)'" "\'0:"day21.txt"

sc:+\1+10!st+\+r:+/''r@&'|~:\(#r:0N 3#1+100!/:!1500)#!2
(3*1+i)*sc@-1+i:*&~1000>sc:,/sc

d:#'=+/'+1+!3 3 3
|/*|+{#x[1;0]}{(p;w):*x;p:,/{(i;s;c):x;+(np;s+1+np:10!i+!d;c*.d)}'p;
               ((*|x);(p@&~m;w+(+/p[;2]@&m:20<p[;1])*+/x[1;0][;2]))}/+(,'st,\:0 1;2#0)
