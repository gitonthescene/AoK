/ This is shakti K

txt:0:"day13.txt";pts:(`i$","\)'*x:(0;*&0=#'txt)^txt;x:(,/"y"=*x;`i$*|x:+"="\'11_'1_x@1)
sh:{d:=x[;1];pg:(*|r)^(*/r:1+|/x)#0;".#"@|/.[pg;;:;1]@'(+(!d;x[;0]d[!d]))}
yf:{?(x@&~w),+(x[;0]@&w;(2*y)-x[;1]@&w:y<x[;1])};xf:{|'yf[|'x;y]}
""0:,$#{((xf;yf)@y)[x;z]}/[pts;1#*x;1#x@1];sh {((xf;yf)@y)[x;z]}/[pts;*x;x@1]
\\