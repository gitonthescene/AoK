/ This is shakti K

txt:0:"day13.txt";x:(r#;(r:*&0=#'txt)_)@\:txt;pts:`i$''(","\)'*x;x:+"="\'11_'1_(:/)x
sh:{d:=x[;1];pg:(*r)^(*/r:1+||/x)#0;".#"@|/.[pg;;:;1]@'(+(!d;x[;0]d[!d]))}
yf:{?(x@&~w),+(x[;0]@&w;(2*y)-x[;1]@&w:y<x[;1])};xf:{|'yf[|'x;y]};a:(*'"y"=*x;`i$(:/)x)
""0:,$#{((xf;yf)@y)[x;z]}/[pts;1#*a;1#(:/)a];sh {((xf;yf)@y)[x;z]}/[pts;*a;(:/)a]
\\