/ This is shakti K

txt:0:"day13.txt";pts:(`i$","\)'*x:(0;*&0=#'txt)^txt;x:(,/"y"=*x;`i$*|x:+"="\'11_'1_x@1)
sh:{".#"@|/.[(1+|/!d)^(*/1+|/x)#0;;:;1]@'(+(!d;(d:x[;0]@=x[;1])[]))}
yf:{?(x@&~w),+(x[;0]@&w;(2*y)-x[;1]@&w:y<x[;1])};xf:{|'yf[|'x;y]}
""0:,$#*r:{((xf;yf)@y)[x;z]}\[pts;*x;x@1];sh (:/)r
\\