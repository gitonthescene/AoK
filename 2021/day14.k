txt:0:"day14.txt"
r:(`n$'+2#r)!`n$'+-1#r:+l:(2_txt)@\:0 1 6
n:(k!(#k:`n$',/(l,/:\:l:?,/l))#0),#'=`n$1_,':|txt@0
sp:{(x-(i@l)!x@i@l)+(!nxt)!+/'(x@i@l,l)@(nxt:=`n$+,/'+(2#;-2#)@\:1_p,1#p:(|+$'i@l),+$'r@i@l:&~`=r[i:&0<x])[]}
a:{rs:(x;sp)/:n;--/*+(1#;-1#)@\:^(-_-(+/'(rs[],rs[])@=,/+$:'!rs)%2)[]}