I:-1_1:"day9.txt"
I:.'I,"0"

i:-2!*/1(~2!)\2+!#I

m:#/:/|1(&/#:')\{|y}\&'~:\~R:i@&I
+/*/1(!#:)\0|-1+{@[R;x;:;|(0;R x 1)]}@@\:/1(&</)\m

l:{|y}\|+0N 2#I
r:+*|{(x;l):x;r:@[x*z>-1+!#x;g:*>~y>x;-; y];(r;l,,(z;g))}/[(0,*l;!0);*|l;|!#*l]
rid:0 1+2*0 -1+r@\:&1&r[1]

s:*'(ss:0,+\I)@?rid 1
s+:-1_/:0,/:+\'l:I@m:rid[0]@=rid 1

+/*/1(!#:)\0|-1+@[R;,//'(ss[m];s)+'\:!''l;:;(0;,/i[m]@'&'l)]
