I:.*0:"day11.txt"

dg:{$[x~0;1;~10!x;1+o@-10!x;1+_%/`ln'(x;10)]}
rep:{$[ ~x;1
  (x>1)&~2!d:dg x;!\:[--:\10/~!1+-2!d;x]
  2024*x]}

col:{(n;s):x[1]@&'1~:\^x[0]?x 1;(x[0],?n;,/rep'n)} / collect
r:75 col/(,0N;I)  / 75 rounds
s:@/1<:\1_r[0]    / seen

dp:*'|'75{(1+y 0;+/'y[1]x?rep'x)}[s]\(0;1+&#s) / DP
+/'dp[25 75;s?I]
