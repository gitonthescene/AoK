I:0:"day8.txt"

S:-1_#'*:\I

fc:("0"+!10),/"aA"+\:!26
f:fc@?(^:)_,/fc?I
prs:{@/1(&&\~=#:)\+&I=x}

fl:(|/'0>)_((&/S>)')#

#?fl@,/{{,/(+(x;y)){1((-:\y)+')/x}'(2*y-x)}/prs x}'f
#?fl@,/{2,//{(+(x;x)){(#fl@)((-:\y)+')\x}'(y-x)}/prs x}'f
