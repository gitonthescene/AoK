I:(0:"day8.txt")-"0"
f:(0,&/'1_-1_'>/1(,\)\)'
r:f@I
r|:|'f@|'I
r|:+f@+I
r|:|+f@+|I
(+//-1_1_-1_'1_'r)+-4+2*+/-1_#'*:\I

g:(&/'(#:;{1+(x,1)?1})@\:/:~>/1(|\'1_'|',\)\)'

r:,g@I
r,:,|'g@|'I
r,:,+g@+I
|//*/r,:,|+g@+|I
