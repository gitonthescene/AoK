I:(*|":"\)''2_'_/|1(&~#:')\(,""),0:"day11.txt"
(I;M):+{(o;v):-2#" "\x@1;,/'0 1_(`I$((1_'","\*x);(*|(" ")\)'-3#x)),(.*o),`I$v}'I

m:{(t;f;op;v):1_y;w,$[~(*y)!w:x!op/z,z^v;t;f]}
r:{{C[z]+:#y@z;$[~#y@z;y;@[@[;;,;]/[y;;].|+m[x;M[z];]'y@z;z;:;!0]]}[x]/[y;!#M]}
doit:{C::(#z)#0;r[y]/[x;z];*/2#@/1>:\C}

doit[20;-3;I]
doit[10000;*/*+M;I]
